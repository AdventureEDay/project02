<html>

<head>
  <script src="../jbrowse-linear-view.js"></script>
</head>

<body>
  <!-- <h1>We're using JBrowse Linear View!</h1> -->
  <div id="jbrowse_linear_view"></div>
  <button data-type="gene_button" data-location="chr10:94762681..94855547">
    CYP2C19
  </button>
  <button data-type="gene_button" data-location="chr13:32315086..32400266">
    BRCA2
  </button>
  <script type="module">
    import assembly from './assembly.js'
    import tracks from './tracks.js'
    const updates = document.getElementById('update')
    // let location = 'chr1:100,987,269..100,987,368'

    const genomeView = new JBrowseLinearView({
      container: document.getElementById('jbrowse_linear_view'),
      assembly,
      tracks,
      // location: location, // 不添加location选项的时候，进入页面的时候不直接进入显示页面
      onChange: patch => {
        updates.innerHTML += JSON.stringify(patch) + '\n'
      },
    })
    
    function navTo(event) {
      genomeView.view.navToLocString(event.target.dataset.location)
    }
    const buttons = document.getElementsByTagName('button')
    for (const button of buttons) {
      if (button.dataset.type === 'gene_button') {
        button.addEventListener('click', navTo)
      }
    }
    const textArea = document.getElementById('viewstate')
    document.getElementById('showviewstate').addEventListener('click', () => {
      // textArea.innerHTML = JSON.stringify(genomeView.view.displayedRegions, undefined, 2)
      textArea.innerHTML = JSON.stringify(genomeView.view, undefined, 2)
    })
  </script>
  <button id="showviewstate">Show view state</button>
  <textarea id="viewstate" name="viewstate" rows="20" cols="80"></textarea>
  <p>updates:</p>
  <textarea id="update" name="update" rows="5" cols="80" wrap="off"></textarea>
</body>

</html>